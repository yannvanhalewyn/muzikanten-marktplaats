<!-- The author links -->
<% if current_user == @advert.user %>
  <div id="author-options" class="panel panel-warning">
    <div class="panel-heading">
      <%= t('adverts.seller-options') %>
    </div>

    <div class="panel-body">
      <p> <strong>Status: </strong>
        <% if @advert.for_sale? %>
          <span><%= t("adverts.state.for_sale") %></span>
        <% else %>
          <%= link_to t("adverts.state.for_sale"), set_for_sale_advert_path(@advert), method: :put %>
        <% end %>
        |
        <% if @advert.reserved? %>
          <span><%= t("adverts.state.reserved") %></span>
        <% else %>
          <%= link_to "Gereserveerd", reserve_advert_path(@advert),
                        method: :put %>
        <% end %>
        |
        <% if @advert.sold? %>
          <span><%= t("adverts.state.sold") %></span>
        <% else %>
          <%= link_to "Verkocht", sell_advert_path(@advert),
                        method: :put %>
        <% end %>
      </p>
      <%= link_to t("adverts.edit"), edit_advert_path(@advert),
                        class: "btn btn-warning" %>
      <%= link_to t("adverts.delete"), advert_path(@advert),
                        method: :delete,
                        class: "btn btn-danger",
                        data: {confirm: t("alert.confirm-delete")} %>
    </div>
  </div>
  <!-- The seller widget -->
<% else %>
  <div id="seller-widget">
    <%= link_to user_path @advert.user do %>
      <h2><%= t("adverts.seller") %></h2>
      <img src="<%= @advert.user.image %>" alt="">
      <p class="seller-name"><%= @advert.user.name %></p>
    <% end %>
  </div>

<% end %>

<!-- The advert title -->
<h1 class="advert-title">
  <%= @advert.title %>
  <% unless @advert.for_sale? %>
    <small><%= t("adverts.state.#{@advert.state}") %></small>
  <% end %>
</h1>

<!-- Images -->
<div class="advert-images row">
  <% @advert.images.each do |image| %>
    <div class="advert-image col-sm-3">
      <%= image_tag image.asset.medium.url %>
    </div>
  <% end %>
</div>


<!-- The advert info -->
<p><%= @advert.description %></p>
<% if @advert.price %>
  <p><%= t("adverts.target-price") %>: <%= number_to_currency(@advert.price, unit: "€") %></p>
<% else %>
  <p>Prijs is niet gespecifiëerd</p>
<% end %>

<!-- Comment section -->
<div class="comment-section">
  <h1><%= t("comments.title") %></h1>

  <% if @advert.comments.empty? %>
    <p><%= t('comments.no-comments-yet') %></p>
  <% end %>

  <ul class="comments">
    <% @advert.comments.order(:created_at).each do |comment| %>
      <li class="comment" id="comment_<%= comment.id %>">
        <% if comment.user %>
          <%= link_to user_path(comment.user) do %>
            <p class="author">
              <img src="<%= comment.user.image %>" alt="">
              <strong class="author-name"><%= comment.user.name %>:</strong>
            </p>
          <% end %>
        <% end %>
        <p class="comment-content">
        <%= comment.content %><br>
          <small class="comment-timetag"><%= time_ago_in_words comment.created_at %></small>
        </p>
      </li>
    <% end %>
  </ul>

  <!-- new comment form -->
  <% if current_user %>
    <%= form_for [@advert, @advert.comments.new] do |form| %>
      <%= form.text_area :content %>
      <%= form.submit t("comments.add-comment") %>
    <% end %>
  <% else %>
    <p><%= t("comments.not-logged-in") %></p>
  <% end %>

</div>
